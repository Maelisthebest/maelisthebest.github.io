<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Login / Registrierung</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
body { font-family: Arial; text-align:center; margin-top:50px; }
input, button { padding:8px; margin:5px; width:250px; }
</style>
</head>
<body>

<h2>ğŸ” Login / Registrierung</h2>

<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Passwort"><br>
<input type="text" id="username" placeholder="Benutzername (nur Registrierung)"><br>

<button onclick="register()">Registrieren</button><br>
<button onclick="login()">Login</button><br>

<p id="message" style="color:red"></p>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCp6Aon4b-sLmUdRaf3sdyKN0y4QK2Zil4",
  authDomain: "maelist-chat.firebaseapp.com",
  databaseURL: "https://maelist-chat-default-rtdb.firebaseio.com/",
  projectId: "maelist-chat",
  storageBucket: "maelist-chat.firebasestorage.app",
  messagingSenderId: "87392900284",
  appId: "1:87392900284:web:fd39fe7161bfa828976cb9",
  measurementId: "G-GK0KNPV152"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// Registrierung
function register() {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const username = document.getElementById('username').value;
  if(!email || !password || !username){ alert("Alle Felder ausfÃ¼llen"); return; }

  auth.createUserWithEmailAndPassword(email, password)
    .then(cred => {
      // Benutzername speichern
      db.ref('users/' + cred.user.uid).set({ username: username });
      window.location.href = "chat.html";
    })
    .catch(err => document.getElementById('message').textContent = err.message);
}

// Login
function login() {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  auth.signInWithEmailAndPassword(email, password)
    .then(() => window.location.href = "chat.html")
    .catch(err => document.getElementById('message').textContent = err.message);
}

// PrÃ¼fen, ob schon eingeloggt
auth.onAuthStateChanged(user => {
  if(user) window.location.href = "chat.html";
});
</script>
</body>
</html>
